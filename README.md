# PWM_Signal_Generation_and_Monitoring_System
Final Lab Project for CENG355: Microprocessor-Based Systems at the University of Victoria

## Problem Description
Configure the STMF0 microcontroller to read the pulse-width-modulated (PWM) signal from the external NE555 timer. Use the microcontroller to drive the 4N35 Optocoupler to control the frequency of the PWM signal using the measured voltage across the potentiometer (POT) on the PBMCUSLK. Use the microcontroller to read and output the PWM frequency along with the POT resistance to the LCD display. 

The system has been broken down into the following block diagram:
![block_digram1](https://user-images.githubusercontent.com/978364/51948032-e9de9800-23db-11e9-9c39-cd9b0b58f613.png)

## The Specifications
-	A NE555 timer will be used to generate the square-wave signal, and the LCD will be used to display the signal frequency and the POT resistance.
-	The STM32F051R8T6 MCU mounted on the STM32F0 Discovery board features built-in analog-to-digital converter (ADC), digital-to-analog converter (DAC), and serial peripheral interface (SPI). The DAC will be used to drive the 4N35 optocoupler to adjust the signal frequency of the NE555 timer, based on the potentiometer voltage read by the ADC, and the SPI will be used to communicate with the LCD. 
-	The analog voltage signal coming from the potentiometer on the PBMCUSLK board will be measured continuously by the ADC â€“ this task is to be accomplished using a polling approach. Using those voltage measurements, the corresponding potentiometer resistance value will be calculated. 
-	Use the digital value obtained from the ADC to adjust the frequency of the PWM signal generated by the NE555 timer. For that purpose, the DAC will be used to convert that digital value to an analog voltage signal driving the 4N35 optocoupler. 
-	To display the signal frequency and the potentiometer resistance, the SPI will be used and configured to drive the LCD on the PBMCUSLK board. 
-	The LCD is a 4-bit, 2-by-8 character display, and there is no direct write access the LCD pins. The only way to control the LCD pins is through the 8-bit 74HC595 shift register on the PBMCUSLK board. The 74HC595 shift register will need to receive 8-bit words from the SPI via the serial MOSI port, appropriately timed using the latch clock LCK and the serial shift register clock SCK. Each 8-bit word sent by the SPI will need to include LCD data bits D3-D0, register-select bit RS, and enable bit EN. 

## The Implementation

The following block diagram was created to outline the flow of the code within main(). A large part of the code is the initiation of each subsystem, with a while loop at the end running the code to output values to the LCD

![block_digram2](https://user-images.githubusercontent.com/978364/51948044-f2cf6980-23db-11e9-8ed1-bcfc3d97bd51.png)
